Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 57 Min Remaining 
Modernizing .NET using Azure Migrate and GitHub Copilot tools
Welcome
Log In to the Virtual Machine.
Username : Admin
Password : Passw0rd!

Welcome to the Modernizing .NET Apps using Azure Migrate and GitHub Copilot tools Lab! In this lab, you will perform an assessment on three .NET applications, migrate two of the applications to Azure App Service, perform code scan using Azure Migrate application and code assessment for .NET, use GitHub Copilot chat for autocomplete-style suggestions and experiment with a few of the modernization features available in App Service. Please follow the steps below to get started on your journey.

Explore the applications
Go to the Windows Search bar and search for Internet Information Services (IIS) Manager. Open the Internet Information Services Manager.
Expand the connection on the left and then expand Sites. You will see three applications:
devshop, .NET Framework v4.8 application running on Port 80
aoiapp, .NET Framework v4.8 application running on Port 8000
Default web site, simple HTML application running on Port 9000 using Windows Authentication inetmgr.jpg
These applications are intended to demonstrate three scenarios:

An application that is ready to be migrated to Azure App Service with no modifications (devshop)
An application that is ready to be migrated, but requires minor modifications to work properly on App Service(aoiapp)
An application that is not ready to be migrated and requires major modifications to be migrated to App Service(Default web site)
Continue to the next step to begin assessing the three applications.

Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 53 Min Remaining 
Assessment
During this part of the lab, you will run a PowerShell script that runs several baseline checks on the applications running in IIS. It will generate a json file that tells you about the migration status of each application.

This Lab is designed using PowerShell cmdlets only. AZ CLI usage may cause errors.

Open a new Windows PowerShell window in Admin mode by typing PowerShell into the Windows Search bar, right clicking on Windows PowerShell and selecting "Run as Administrator". Select Yes when prompted.
Change directory to the C:\scripts folder by running cd C:\scripts in the PowerShell window
Run the application assessment script by running .\Get-SiteReadiness.ps1 -OverwriteReadinessResults
After the script has completed, open the ReadinessResults.json file located in the same folder that was generated by the scripts by running code ReadinessResults.json.
You will see assessment results for the three applications:
default web site will indicate that it cannot be migrated due to Windows Authentication configuration & LocationTagCheck and also has warnings related to TCPPort.
devshop will indicate that it is fully ready to be migrated and generates no warnings or checks.
aoiapp will indicate that it could be migrated, but generates a warning about the port
Keep your PowerShell window open for the upcoming migration step and continue to the next step.


Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 53 Min Remaining 
GitHub Copilot Configuration
Before proceeding with using Azure Migrate application and code assessment extension we need to connect and configure Copilot with an active Github Enterprise Account using the steps described below. Please ensure to follow all the steps sequently and exactly as described.

Open Microsoft Edge Browser and click https://github.com/enterprises/skillable-events/sso
GH1.png
On the next screen click continue
GH2.png
Sigin in with GitHub Username User1-51501459@LODSPRODMCA.onmicrosoft.com
GH3.png
Provide the GitHub Password as eS0qNr+D8!
GH4.png
Once authenticated you should see following screen. Click Yes (You can click No on other popups that appear.)
GH5.png
Finally you will be presented with following screen. Do NOT Close The Browser. If you do so subsequent steps will fail and you will be required to repeat steps 1-6 as described above.
GH6.png
Open Visual Studio 2022. Switch to GitHub Copilot chat window .
GH7.png
Open an existing solution C:\Users\Admin\source\repos\devShop\devShop\devShop.sln
GH8.png
On this screen click on "Add GitHub Account" button.
GH9.png
A new tab in Microsoft Edge browser will open. Click "Continue" next to the user name which is similar to User1-&&&&_MSFTGHE. This will ensure that GitHub Copilot is activated using the logged-in GitHub Enterprise user. If You have accidentaly closed the browser window please repeat step 1-6 and then return to step 10.
GH10.png
11.On the next screen click "Authorize GitHub"
GH11.png
12.On the next screen click "Open".
GH12.png
Next screen will configure OAUTH between GitHub and Visual Studio 2022. (A commend window will auto open and close. No action is required)
GH13.png
GitHub Copilot is now authenticated, configured and ready for use.
GH14.png
Continue to the next step.

Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 49 Min Remaining 
GitHub Copilot Configuration
Before proceeding with using Azure Migrate application and code assessment extension we need to connect and configure Copilot with an active Github Enterprise Account using the steps described below. Please ensure to follow all the steps sequently and exactly as described.

Open Microsoft Edge Browser and click https://github.com/enterprises/skillable-events/sso
GH1.png
On the next screen click continue
GH2.png
Sigin in with GitHub Username User1-51501459@LODSPRODMCA.onmicrosoft.com
GH3.png
Provide the GitHub Password as eS0qNr+D8!
GH4.png
Once authenticated you should see following screen. Click Yes (You can click No on other popups that appear.)
GH5.png
Finally you will be presented with following screen. Do NOT Close The Browser. If you do so subsequent steps will fail and you will be required to repeat steps 1-6 as described above.
GH6.png
Open Visual Studio 2022. Switch to GitHub Copilot chat window .
GH7.png
Open an existing solution C:\Users\Admin\source\repos\devShop\devShop\devShop.sln
GH8.png
On this screen click on "Add GitHub Account" button.
GH9.png
A new tab in Microsoft Edge browser will open. Click "Continue" next to the user name which is similar to User1-&&&&_MSFTGHE. This will ensure that GitHub Copilot is activated using the logged-in GitHub Enterprise user. If You have accidentaly closed the browser window please repeat step 1-6 and then return to step 10.
GH10.png
11.On the next screen click "Authorize GitHub"
GH11.png
12.On the next screen click "Open".
GH12.png
Next screen will configure OAUTH between GitHub and Visual Studio 2022. (A commend window will auto open and close. No action is required)
GH13.png
GitHub Copilot is now authenticated, configured and ready for use.
GH14.png
Continue to the next step.


Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 30 Min Remaining 
Prepare to scan code using Azure Migrate application and code assessment for .NET
In this step we will use the Azure Migrate application and code assessment for .NET Visual Studio extension to scan code for the devshop web app . This extension provides details about code changes that may be required before the web app is migrated to App Service. For this lab Azure Migrate application and code assessment extension is pre-installed but you can download this extension from https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.appcat

Please note:
* As part of this step we will implement a code related to "Log4Net" in the desvhop application, Details provided below.

*Code changes required for Azure OpenAI integration with sample ASP.NET web app (devshop.sln) are already implemented and no changes are require



In the already open Visual Studio 2022 window and navigate to "solution explorer" (C:\Users\Admin\source\repos\devShop\devShop\devShop.sln ).In the solution explorer Right click on the "devshop" project and click "Re-platform to Azure".
AC1.png
On this screen select "New Report"
AC2.png
For the purpose of this lab Select "Azure App Service (Windows)" as target service on Azure. Click "Next"
AC3.png
By default all projects within the solution are selected. Leave the selection as-is and click "Next"
AC4.png
For purpose of this lab we will analyze source code and settings (you can also include binary dependencies and define custom settings if needed). On this screen leave the default selection as-is and click "Analyze"
AC5.png
Once complete you will be presented with a summary dashbaord.
AC6.png
Click "Aggregate issues" on the left menu.
appcat_aggregate_issues.jpg
Expand the issue "Local.0004".It is reported that devshop has "Logging to local or network path" configured. If you refer to the corresponding web.config file then you will see that this application uses log4net for logging errors to local disk. The severity of this issue is "Mandatory".
Let us fix this issue using GitHub Copilot . Click on "Ask Copilot" on the top right. A new Copilot chat window opens with possible resolution(s) for this issue.
appcat_log4net_1.jpg
appcat_log4net_2.jpg
Based on GitHub Copilot guidance we will implement following changes to the devshop application.
Install "Microsoft.ApplicationInsights.Log4NetAppender" NuGet package. To install this package right click "devshop" project and select "Manage NuGet Packages". Make sure that you are on the "Browse" tab. (Ensure that "All" or "nuget.org" is selected in the "Package source" dropdown on the top right corner.)
Nuget.jpg
Once this package is installed open web.config for devshop project.
webconfig.jpg
In the "web.config" make following changes.

webconfig_2.jpg

Replace existing log4net tag details as shown above with the following changes.

<log4net debug="true">

 <appender name="ApplicationInsightsAppender" type="Microsoft.ApplicationInsights.Log4NetAppender.ApplicationInsightsAppender, Microsoft.ApplicationInsights.Log4NetAppender">
  <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger - %message%newline" />
  </layout>
 </appender>

<root>
    <level value="ALL" />

    <appender-ref ref="ApplicationInsightsAppender"/>

</root>
    </log4net>
Save "web.config" file.

Now Right the "devshop" project and click "Rebuild" solution.
Once "Rebuild" is complete . Once again right click the "devshop" project and click "Publish". This will publish the code changes to localhost.
publish.jpg
Close the issue "Local.0004" . Now expand the issue "Security.0002".It is reported that aoiwebapp has "Connection Strings" defined in the web.config file. Click on "Ask Copilot" on the top right. A new Copilot chat window opens with possible resolution(s) for this issue. (for the purpose of this lab we will not make code changes)
appcat_security0002.jpg
Close Visual Studio

Continue to the next step.

Modernizing .NET using Azure Migrate and GitHub Copilot tools
1 Hr 30 Min Remaining 
Prepare the application for migration
In this step of the lab, you will prepare the application for migration. You will run a PowerShell script that zips up the website for the migration process.

Go back to the PowerShell window that's already open. Run .\Get-SitePackage.ps1 -ReadinessResultsFilePath ReadinessResults.json -PackageResultsFileName "PackageResults.json" -Force . We will omit packaging "Default Web Site" because the assessment results as performed above reported an error.
Run Connect-AzAccount. In the browser window provide Azure username and password from the resources section of the lab.
Prepare the migration settings for the migration script by running .\Generate-MigrationSettings.ps1 -SitePackageResultsPath packagedsites\PackageResults.json -Region northcentralus -SubscriptionId 89c54b68-ea45-4843-9edb-529e2e77baf7 -ResourceGroup Build2025 -Force .
After the script has finished, open the MigrationSettings.json file by running code MigrationSettings.json. Modify the AzureSiteName . From devshop to devshop51501459 and aoiapp to aoiapp51501459 . Remember to change names for both the AzureSiteName variables as shown because the names need to be globally unique for DNS resolution.
Save the file
Continue to the next step.

